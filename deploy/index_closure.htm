<!doctype html>
	<html>

<head>
	<meta charset="UTF-8">
	<meta http-equiv="x-ua-compatible" content="IE=Edge"/>

	<meta name="application-name" property="og:title" content="BeamCalc S2">
	<meta name="description" property="og:description" content="Calculates the capacity of rectangular concrete beams to AS3600 2009. Shows calculation workings. Developed for my undergraduate thesis project.">
	<meta name="thumbnail" property="og:image" content="http://engineernick.com/bc/img/thumbnail.png">
	<meta property="og:url" content="http://engineernick.com/bc/">
	<meta name="author" content="Nicholas Archer">
	<meta name="date" content="2014-09-01">

	<title>BeamCalc S2</title>
	
	<link rel="stylesheet" href="style/index.css" type="text/css"/>
	<script type="text/x-mathjax-config">
		MathJax.Hub.Config({
			extensions: ["tex2jax.js"],
			jax: ["input/TeX","output/HTML-CSS"],
			tex2jax: {inlineMath: [["$$","$$"],["$$$","$$$"]]},
			messageStyle: "none",
			skipStartupTypeset: true,
			menuSettings: {
				//context: "Browser"
			},
			Tex:{
				extensions: ["color.js"]
			}
		});
	</script>
	
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!---->
<!--<script type="text/javascript" src="js/mathjax/MathJax.js"></script>-->

</head>


<body>
	<div id="secondarycol">
		<div id="apptitlebox" class="bmpblock">
			<a href="img/infosheet.pdf" download="InfoSheet.pdf" target="_blank" style="font-size:1.5em;">
				Click Here to Download <br>Study Info Sheet / Ethical Approval Info
			</a>
		</div>
		
		
		<div id="protips" class="protip">
			<div class="tips"></div>
			<div class="feedback"></div>
		</div>
		
		<div id="varinfodiv" class="bmpblock" >
			<!-- 
				HELP INFO GOES HERE
			-->
		</div>
	</div>
	
	<div id="maincol">	
		
		
		<div id="invardiv" class="bmpblock">
			<div style="width:100%;">
				<h2>General Variables</h2>
			</div>
			<div id="invardiv-content">
				<!--
					Variable inputs go here!
				-->
			</div>
		</div>
		
		<div id="reoinputdiv" class="bmpblock">
			<div style="width:100%;">
				<h2>Reinforcement Information</h2>
			</div>
			<div id="reoinputdiv-content">
				<table class="reotable" style="">
					<thead>
						<tr style="font-family:sans-serif;">
							<td style="width:4em;" data-tooltip="Number used to refer to a layer of reinforcement.">
								Layer<br>Number
							</td>
							<td style="width:5em;border-left:none;">Enabled<br>&nbsp;</td>
							<td style="width:3em;">Bars<br>&nbsp;</td>
							<td style="width:30px;border-left:none;"></td>
							<td style="width:6em;">Top/Bottom<br>Position</td>
							<td style="min-width:3em;">Gap<br>(mm)</td>
							<td style="min-width:3em;">Area<br>(mm&sup2;)</td>
							<td style="min-width:3em;">Depth<br>(mm)</td>
						</tr>
					</thead>
					<tbody id="reorows">
						<!--
							REO INPUT CONTROLS HERE
						-->
					</tbody>
					<tfoot>
						<tr>
							<td colspan=6 style="text-align:right;">Sum of Areas:</td>
							<td id="reosumarea" style="border-top:2px solid black;border-bottom:2px solid black;">TODO</td>
							<td></td>
						</tr>
					</tfoot>
				</table>
			</div>
		</div>
		
		
		<div id="crosssectiondiv" class="bmpblock" style="">
			<h2>Cross Section</h2>
			<canvas width="450" height="400" id="crosssectioncanvas" >
				There has been some error! A beam cross section should show up here!
			</canvas>
			<br/>
			<label for="bananaforscalecheck" onclick="b.drawSection(cs_ctx);" data-tooltip="A banana is a poor measure of scale. Please think about how big the real beam is.">
				<input type="checkbox" id="bananaforscalecheck"/> Show Banana For Scale.
			</label>
			<img id="bananascale" src="img/scale.png" style="display:none;"/>
			<p>Note that greyed out bars are shown for crack control. Not included in strength calcs.</p>
		</div>
		
		<div style="flex: 0 0 100%;"></div>
		
		<div id="calcdiv" style="" class="bmpblock">
			<div style="width:100%;">
				<h2>Calculations</h2>
			</div>
			<div id="calcdiv-content">
				<canvas style="margin-top:10px;margin-bottom:10px;" class="dncanvas" width="480" height="300">Canvas not shown</canvas>
			</div>
		</div>
	</div>
	
	
</body>
<script>
if(void 0===calc)var calc={};
calc.alpha2=new function(){CalcDiv.call(this);this.updateTitle=function(){this.title='<a href="#help_bar_alpha2"> &alpha;<sub>2</sub></a> = '+b.alpha2.toFixed(2)+' &nbsp;&nbsp;&nbsp;and&nbsp;&nbsp;&nbsp; <a href="#help_bar_gamma">&gamma;</a> = '+b.gamma.toFixed(2)}.bind(this);this.update=function(){var a=function(a){return"<p>"+a+"</p>"},d;d=""+a("$$$\\begin{aligned}\\alpha_2 &= 1.0 - 0.003 f'_c \\\\&= 1.0-0.003\\times "+b.fc.toFixed(0)+"\\\\&= "+(1-.003*b.fc).toFixed(2)+"\\end{aligned}$$$");d+=a("where $$$0.67 \\le \\alpha_2 \\le 0.85 $$$");
d+=a(" &there4; $$$\\alpha_2 = "+b.alpha2.toFixed(2)+" $$$");var c;c=""+a("$$$\\begin{aligned}\\gamma &= 1.05 - 0.007 f'_c \\\\&= 1.05-0.007\\times "+b.fc.toFixed(0)+"\\\\&= "+(1.05-.007*b.fc).toFixed(2)+"\\end{aligned}$$$");c+=a("where $$$0.67 \\le \\gamma \\le 0.85 $$$");c+=a(" &there4; $$$\\gamma = "+b.gamma.toFixed(2)+" $$$");this.content=a("From AS3600 Section 8.1.3(b)(ii)")+'<table style="width:100%;"><tr><td>'+d+"</td><td>"+c+"</td></tr></table>";this.updateMathJax()}.bind(this);this.on("init",
this.updateTitle);this.on("show",this.update)};void 0===calc&&(calc={});
calc.checks=new function(){CalcDiv.call(this);this.updateTitle=function(){this.title="Other Values"}.bind(this);this.update=function(){this.content="";this.addParagraph("This software does not check serviceability requirements (yet).");this.addParagraph("Values for which calculations are not shown in this software: $$\\begin{aligned}I_g &= "+b.Ixx.toFixed(0)+" ~mm^4\\\\Z_e &= "+b.Ze.toFixed(0)+" ~mm^3 \\\\A_g &= "+b.Ag.toFixed(0)+" ~mm^2 \\\\f'_{ct.f} &= "+b.fctf.toFixed(2)+" MPa \\\\(M_{uo})_{min} &= "+
b.Muo_min.toFixed(0)+" ~kNm ~(\\text{See AS3600 8.1.6.1}) \\\\(A_{st})_{min} &= "+b.Muo_min_Ast_min.toFixed(0)+" ~mm^2 ~(\\text{See AS3600 8.1.6.1}) \\\\\\end{aligned}$$");this.updateMathJax()}.bind(this);this.on("init",this.updateTitle);this.on("show",this.update)};void 0===calc&&(calc={});
calc.dn=new function(){CalcDiv.call(this);this.updateTitle=function(){this.title='<a href="#help_bar_dn">d<sub>n</sub></a> = '+b.dn.toFixed(0)+" mm"}.bind(this);this.update=function(){this.updateTitle();this.content="";this.addParagraph("Depth to neutral axis ($$$\\href{#help_bar_dn}{d_n}$$$) is calculated by the 'Rectangular Stress Block' Method (See the diagram above). This involves solving the internal horizontal forces in the beam at ultimate loading:");this.addParagraph("$$\\sum F_x = C_c + C_s + T_s = 0\\\\~\\\\~\\\\\\begin{aligned}Where~~ C_c &= \\href{#help_bar_Cc}{\\text{Compression in Concrete}}\t& {} &= \\alpha_2f'_c \\times (b)(\\gamma \\color{green}{d_n}) \\\\\t\t C_s &= \\href{#help_bar_Cs}{\\text{Compression in Steel}}\t\t\t& {} &= E_s \\sum(\\color{brown}{\\epsilon_{s i}} A_{s i}) \\\\\t\t T_s &= \\href{#help_bar_Ts}{\\text{Tension in Steel}}\t\t\t\t& {} &= E_s \\sum(\\color{brown}{\\epsilon_{s i}} A_{s i})\\\\\t\t\\\\b &= \\href{#help_bar_b}{\\text{Breadth of beam}} & {} &= "+b.b+
"mm\\\\{A_{s i}} &= \\href{#help_bar_As}{\\text{Area of reo in layer i}}\\\\\\color{brown}{\\epsilon_{s i}} &= \\href{#help_bar_epsilonsi}{\\text{Strain in reo layer i}} & {} &= 0.003 ({{d_i}/\\color{green}{d_n}} - 1)\\\\&Where~~~&  &-\\epsilon_{sy}\\le \\color{brown}{\\epsilon_{s i}} \\le \\epsilon_{sy}\\\\\\epsilon_{s y} &= \\href{#help_bar_epsilonsy}{\\text{Steel Yeild Strain}} & {} &= 0.0025 \\\\\\epsilon_{c max} &= \\href{#help_bar_epsiloncmax}{\\text{Highest allowable strain in Concrete}} & {} &= 0.003 \\\\E_s &= \\href{#help_bar_Es}{\\text{Young's Modulus of Steel}} & {} &= 200000MPa\\end{aligned}$$");
this.addParagraph("At this point, there are 3 unknowns:");this.addParagraph("<ol><li>$$$ \\color{green}{d_n} $$$</li><li>Which layers are in tension and which are in compression?</li><li>Which steel layers are yeilded/elastic?</li></ol>");this.addParagraph("You need to make assumptions for 2 & 3. <b>This software solves this problem by brute force guess-and check. The strain diagram above shows which layers are in tension/compression and yeilded/elastic</b>");b_dn=b.dn;var a=[];a.push("C_c &= (\\alpha_2 f_c)(b \\times \\gamma \\color{green}{d_n})");
var d=[];d.push("C_c &= ("+b.alpha2.toFixed(2)+"\\times"+b.fc.toFixed(0)+")("+b.b.toFixed(0)+"\\times"+b.gamma.toFixed(2)+"  \\color{green}{d_n}) &&N");var c=[];c.push("C_c &= -"+(b.alpha2*b.fc*b.b*b.gamma/1E3).toFixed(2)+"\\color{green}{d_n} &kN");for(var e=[],g=[{dn:1,val:-b.alpha2*b.fc*b.b*b.gamma}],f=b.reo.length-1;0<=f;f--){var h=b.layer_strain_from_layer_dn(b.reo[f],b_dn,!0),k="",k=0>=h?"-":"",m=null,l=0,n=0;.0025<=Math.abs(h)?(e.push("\\epsilon_{s"+f+"} &= yielded &  {} &= "+k+"0.0025"),m=
k+"0.0025",n=0,l=parseFloat(m)):(e.push("\\epsilon_{s"+f+"} &= elastic &  {} &= 0.003( "+b.reo[f].depth.toFixed(0)+" / {\\color{green}{d_n}} - 1)"),m="0.003( "+b.reo[f].depth.toFixed(0)+" / {\\color{green}{d_n}} - 1)",n=.003*b.reo[f].depth,l=-.003);0>=h?(a.push("C_{s"+f+"} &= E_s \\times ([\\epsilon_{s"+f+"}] \\times A_{s"+f+"})"),d.push("C_{s"+f+"} &= "+b.Es+" \\times (["+m+"] &\\times "+b.reo[f].area.toFixed(0)+") &N"),0!==n?(c.push("C_{s"+f+"} &= {"+(b.Es*b.reo[f].area*n/1E3).toFixed(0)+"} /{\\color{green}{d_n}} "+
(b.Es*b.reo[f].area*l/1E3).toFixed(0)+" &kN"),g.push({dn:-1,val:b.Es*b.reo[f].area*n})):c.push("C_{s"+f+"} &= "+(b.Es*b.reo[f].area*l/1E3).toFixed(0)+" &kN")):(a.push("T_{s"+f+"} &= E_s \\times ([\\epsilon_{s"+f+"}] \\times A_{s"+f+"})"),d.push("T_{s"+f+"} &= "+b.Es+" \\times (["+m+"] &\\times "+b.reo[f].area.toFixed(0)+") &N"),0!==n?(c.push("T_{s"+f+"} &= {"+(b.Es*b.reo[f].area*n/1E3).toFixed(0)+"} /{\\color{green}{d_n}} "+(b.Es*b.reo[f].area*l/1E3).toFixed(0)+" &kN"),g.push({dn:-1,val:b.Es*b.reo[f].area*
n})):c.push("T_{s"+f+"} &= "+(b.Es*b.reo[f].area*l/1E3).toFixed(0)+" &kN"));g.push({dn:0,val:b.Es*b.reo[f].area*l})}g.sort(function(a,c){return a.dn-c.dn});h=[0,0,0];for(f=0;f<g.length;f++)line=g[f],0>g[0].dn?h[line.dn+1]+=line.val:h[line.dn]+=line.val;console.log(g);console.log(h);f=[];0!==h[2]&&f.push("("+(h[2]/1E3).toFixed(2)+"){\\color{green}{d^2_n}}");0!==h[1]&&f.push("("+(h[1]/1E3).toFixed(2)+"){\\color{green}{d_n}}");0!==h[0]&&f.push("("+(h[0]/1E3).toFixed(2)+")");this.addParagraph("Here are our strains: (note that yielded layers are at $$$\\epsilon_{sy}$$$)");
this.addParagraph("$$\\begin{aligned}"+e.join("\\\\")+"\\end{aligned}$$");this.addParagraph("And our full equations:");this.addParagraph("$$\\begin{aligned}"+a.join("\\\\")+"\\end{aligned}$$");this.addParagraph("Substituting in all the known values:");this.addParagraph("$$\\begin{aligned}"+d.join("\\\\")+"\\end{aligned}$$");this.addParagraph("Simplifing:");this.addParagraph("$$\\begin{aligned}"+c.join("\\\\")+"\\end{aligned}$$");this.addParagraph("Now resubstitute back into the following equation and solve for $$$\\color{green}{d_n}$$$!");
this.addParagraph("$$\\begin{aligned}\\sum F_x &= C_c + C_s + T_s = 0 \\\\"+(0>g[0].dn?"\\color{green}{d_n} \\times":"")+" \\sum F_x &= "+f.join(" + ")+" = 0\\\\\\color{green}{d_n} &= "+b_dn.toFixed(0)+"mm\\end{aligned}$$");this.updateMathJax()}.bind(this);this.on("init",this.updateTitle);this.on("show",this.update)};calc=calc||{};calc.arr=[calc.alpha2,calc.dn,calc.Muo,calc.kuo];void 0===calc&&(calc={});
calc.kuo=new function(){CalcDiv.call(this);this.updateTitle=function(){var a=b.kuo,d="";this.topdiv.style.backgroundColor="";.36<a&&(d='<span style="color:red"> &gt;0.36 beam is over-reinforced (See AS3600 8.1.5)</span>',this.topdiv.style.backgroundColor="yellow",console.log(this.topdiv));.1>a&&(d='<span style="color:red"> &lt;0.1 beam might be under-reinforced (See AS3600 8.1.5)</span>',this.topdiv.style.backgroundColor="yellow");this.title='<a href="#help_bar_kuo"> k<sub>uo</sub></a> = '+b.kuo.toFixed(3)+
d}.bind(this);this.update=function(){var a=b.kuo;this.content="";this.addParagraph("$$k_{uo} = \\frac{d_n}{d_o}$$");this.addParagraph("Where:");this.addParagraph("$$d_o =\\href{#help_bar_do}{\\text{Depth to lowest reo layer from top surface}} = "+b.d0.toFixed(0)+"$$");this.addParagraph("$$d_n =\\href{#help_bar_dn}{\\text{Depth to Neutral Axis}} = "+b.dn.toFixed(0)+"$$");this.addParagraph("Thus:");this.addParagraph("$$k_{uo} = "+a.toFixed(3)+"$$");.1>a||.36<a?(this.addParagraph('<div class="calcerror">ERROR! $$$k_uo$$$ should be more than ~0.1 and less than 0.36 (Except for in special conditions.) - See AS3600 8.1.5.</div>'),
this.addParagraph('<div class="calcerror">To fix this you must change the depth of the beam or add / remove reinforcment</div>')):this.addParagraph("Within limits: $$$k_{uo}$$$ should be more than ~0.1 and less than 0.36 (Except for in special conditions.) - See AS3600 8.1.5.");this.updateMathJax()}.bind(this);this.on("init",this.updateTitle);this.on("show",this.update)};void 0===calc&&(calc={});
calc.Muo=new function(){CalcDiv.call(this);this.updateTitle=function(){var a=b.Muo_min,d=b.Muo,c="";this.topdiv.style.backgroundColor="";d<a&&(c='<span style="color:red"> &lt; <a href="#help_bar_Muomin">(M<sub>uo</sub>)<sub>min</sub></a>  (= '+a.toFixed(0)+" kNm) (See AS3600 8.1.6 Minimum Capacity)</span>",this.topdiv.style.backgroundColor="yellow");this.title='<a href="#help_bar_Muo"> M<sub>uo</sub></a> = '+d.toFixed(0)+" kNm"+c}.bind(this);this.update=function(){this.content="";b_dn=b.dn;var a=
[];a.push("C_c &= -"+(b.alpha2*b.fc*b.b*b.gamma/1E3).toFixed(2)+"\\color{green}{d_n} &{}&="+b.Cc_from_dn(b_dn).toFixed(1)+" ~kN");for(var d=["\\frac{\\gamma \\color{green}{d_n}}{2} &= "+(b.gamma*b_dn*.5).toFixed(0)+"mm"],c=[b.Cc_from_dn(b_dn).toFixed(1)+"kN \\times&"+(b.gamma*b_dn*.5/1E3).toFixed(3)+"m & {}&="+(b.Cc_from_dn(b_dn)*b.gamma*b_dn*.5/1E3).toFixed(0)+"~kNm"],e=b.reo.length-1;0<=e;e--){d.push("d_{"+e+"} &= "+b.reo[e].depth.toFixed(0)+" mm");var g=b.layer_strain_from_layer_dn(b.reo[e],b_dn,
!0),f=b.layer_force_from_layer_dn(b.reo[e],b_dn);c.push(f.toFixed(1)+"kN \\times& "+(b.reo[e].depth/1E3).toFixed(3)+"m &{}&= "+(f*b.reo[e].depth/1E3).toFixed(1)+"~kNm");var h=1,h=0>=g?-1:1,k=0,m=0;.0025<=Math.abs(g)?(m=0,k=.0025*h):(m=.003*b.reo[e].depth,k=-.003);0>=g?.0025<=Math.abs(g)?a.push("C_{s"+e+"} &= "+(b.Es*b.reo[e].area*k/1E3).toFixed(0)+"&{} &="+f.toFixed(1)+"~kN"):a.push("C_{s"+e+"} &= {"+(b.Es*b.reo[e].area*m/1E3).toFixed(0)+"} /{\\color{green}{d_n}} "+(b.Es*b.reo[e].area*k/1E3).toFixed(0)+
"&{} &= "+f.toFixed(1)+" ~kN"):.0025<=Math.abs(g)?a.push("T_{s"+e+"} &= "+(b.Es*b.reo[e].area*k/1E3).toFixed(0)+"& {}&="+f.toFixed(1)+" ~kN"):a.push("T_{s"+e+"} &= {"+(b.Es*b.reo[e].area*m/1E3).toFixed(0)+"} /{\\color{green}{d_n}} "+(b.Es*b.reo[e].area*k/1E3).toFixed(0)+"& {} &="+f.toFixed(1)+"~kN")}this.addParagraph("$$$M_{uo}$$$ is found by the sum of moments of internal forces at ultimate loading.<br>This software uses the top surface of the beam as the 'fulcrum point' about which moments are calculated.");
this.addParagraph("$$M_{uo} = \\sum M_{\\text{at top surface}} = C_c \\frac{\\gamma d_n}{2} + C_{si}d_i + T_{si}d_i\\\\~\\\\~\\\\\\begin{aligned}Where~~ C_c =& \\href{#help_bar_Cc}{\\text{Compression in Concrete}} \\\\\t\t C_{si} =& \\href{#help_bar_Cs}{\\text{Compression in steel layer i}} \\\\\t\t T_{si} =& \\href{#help_bar_Ts}{\\text{Tension in steel layer i}} \\\\d_i =& \\text{Depth from top of beam}\\\\ & \\text{to centroid of steel layer i} \\\\\\end{aligned}$$");this.addParagraph("To find these values, substitute $$$\\color{green}{d_n = "+
b_dn.toFixed(0)+" mm}$$$ back into the equations developed in the calculations above:");this.addParagraph("$$\\begin{aligned}"+a.join("\\\\")+"\\end{aligned}$$");this.addParagraph("And:");this.addParagraph("$$\\begin{aligned}"+d.join("\\\\")+"\\end{aligned}$$");this.addParagraph("Finally, substitute back into $$$\\sum M_x$$$ equation above:");this.addParagraph("$$\\begin{aligned}\\bf{Force} \\times& \\bf{d_i} &{} &= \\bf{Moment}\\\\"+c.join("\\\\")+"\\\\{}&{}&\\sum {}&=\\overline{\\underline{"+b.Muo.toFixed(0)+
"~kNm}} = M_{uo}\\end{aligned}$$");this.updateMathJax()}.bind(this);this.on("init",this.updateTitle);this.on("show",this.update)};void 0===calc&&(calc={});
calc.phi=new function(){CalcDiv.call(this);this.updateTitle=function(){this.title='<a href="#help_bar_phi">&#x3d5;</a> = '+b.phi.toFixed(2)}.bind(this);this.update=function(){this.content="";this.addParagraph("Find Capacity Reduction Factor From AS3600 from Table 2.2.2 (b)(i)");this.addParagraph("$$\\begin{aligned}\\phi &= 1.19 - \\frac{13}{12} k_{uo} \\\\&= 1.19 - \\frac{13}{12} "+b.kuo.toFixed(3)+"\\\\&= "+(1.19-13/12*b.kuo).toFixed(3)+"\\end{aligned}$$");this.addParagraph("$$Where ~~~ 0.6 \\le \\phi \\le 0.8$$");this.addParagraph("Thus:");
this.addParagraph("$$\\phi = "+b.phi.toFixed(2)+"$$");this.updateMathJax()}.bind(this);this.on("init",this.updateTitle);this.on("show",this.update)};void 0===calc&&(calc={});
calc.phiMuo=new function(){CalcDiv.call(this);this.updateTitle=function(){this.title='<a href="#help_bar_phi">&#x3d5;</a><a href="#help_bar_Muo">M<sub>uo</sub></a> = '+b.phiMuo.toFixed(0)+" kNm"}.bind(this);this.update=function(){this.content="";this.addParagraph("Find Ultimate Capacity According to AS3600 2.2.2:");this.addParagraph("$$\\begin{aligned}\\phi M_{uo} &= "+b.phi.toFixed(2)+"\\times"+b.Muo.toFixed(0)+"~kNm \\\\&= "+b.phiMuo.toFixed(0)+" ~kNm\\end{aligned}$$");this.updateMathJax()}.bind(this);
this.on("init",this.updateTitle);this.on("show",this.update)};var AS3600={};
AS3600["4.10.3.2"]=new function(){this.class_index="A1 A2 B1 B2 C1 C2".split(" ");this.fc_index=[20,25,32,40,50];this.coverdata_standard=[[20,20,20,20,20],[,30,25,20,20],[,,40,30,25],[,,,45,35],[,,,,50],[,,,,65]];this.coverdata_nonstandard=[[20,20,20,20,20],[,30,20,20,20],[,,30,25,20],[,,,35,25],[,,,,45],[,,,,60]];this.get_min_cover_from_fc_eclass=function(a,d){var c=this.fc_index.indexOf(Math.min(a,50)),e=this.class_index.indexOf(d);if(-1===c||-1===e)console.error("error in AS3600['4.10.3.2'] fc or eclass not found");else return this.coverdata_standard[e][c]}.bind(this);
this.get_min_fc_from_eclass=function(a){a=this.class_index.indexOf(a);if(-1===a)console.error("error in AS3600['4.10.3.2'] eclass not found");else{a=this.coverdata_standard[a];for(var d=0;void 0===a[d];d++);return this.fc_index[d]}}.bind(this);this.get_max_eclass_from_fc=function(a){a=this.fc_index.indexOf(Math.min(a,50));if(-1===a)console.error("error in AS3600['4.10.3.2'] fc not found");else{for(var d=this.coverdata_standard.length-1;void 0===this.coverdata_standard[d][a]&&0<=d;d--);return this.class_index[d]}}.bind(this);
this.eclass_lessthan_eclass=function(a,d){return this.class_index.indexOf(a)<this.class_index.indexOf(d)}.bind(this)};Beam.prototype.drawSection=function(a){this.Ts_centroid_depth_from_dn(this.dn);var d=a.canvas,c=Math.min((d.width-210)/this.b,(d.height-80)/this.D);a.clearRect(0,0,d.width,d.height);a.save();a.fillStyle="grey";a.font="15px serif";a.textBaseline="top";a.textAlign="right";a.fillText("Fitment Diameter = "+this.df+" mm",d.width,0);a.fillText("Exposure Class = "+this.eclass+"   ",d.width,20);a.fillText("Concrete Strength = "+this.fc+" MPa",d.width,40);a.fillStyle="red";a.font="25px serif";a.textBaseline=
"top";a.textAlign="right";a.fillText("\u03d5Muo = "+(this.phi*this.Muo).toFixed(0)+" kNm",d.width,70);a.translate(60+this.b/2*c,40+this.D/2*c+(d.height-40-40-this.D*c)/2);a.strokeStyle="#333333";a.lineWidth=2;a.strokeRect(-this.b/2*c,-this.D/2*c,this.b*c,this.D*c);dim(a,-this.b/2*c,-this.D/2*c,-this.b/2*c,this.D/2*c,Math.PI,32,this.D+" mm");dim(a,-this.b/2*c,-this.D/2*c,this.b/2*c,-this.D/2*c,-Math.PI/2,20,this.b+" mm");dim(a,-this.b/2*c,this.D/2*c,-this.b/2*c+this.cover*c,this.D/2*c,Math.PI/2,20,
"");document.querySelector("#bananaforscalecheck")&&document.querySelector("#bananaforscalecheck").checked&&(d=180*c,a.drawImage(document.querySelector("#bananascale"),-d/2,-d/2,d,d));a.fillStyle="black";a.font="15px serif";a.textBaseline="middle";a.textAlign="left";a.fillText("Cover = "+this.cover+" mm",-this.b/2*c+this.cover*c+3,this.D/2*c+20);drawFitment(a,(-this.b/2+this.cover+this.df/2)*c,(-this.D/2+this.cover+this.df/2)*c,(this.b-2*this.cover-this.df)*c,(this.D-2*this.cover-this.df)*c,3*this.df/
2*c,30*c,this.df*c);for(var d=this.reo.concat([]),e=0;e<d.length;e++)d[e].index=e;d.sort(function(a,c){return a.depth-c.depth});var g=-Infinity;a.fillStyle="black";for(e=0;e<d.length;e++){for(var f=d[e],h=(this.b-2*(this.cover+this.df)-f.diameter)/(f.number-1),k=0;k<f.number;k++)a.fillCircle((-this.b/2+this.cover+this.df+f.diameter/2+k*h)*c,(-this.D/2+f.depth)*c,f.diameter/2*c);h=-this.D/2*c+f.depth*c;g>=h-15&&(h=g+15);g=h;a.font="15px sans-serif";a.fillText("Layer "+f.index+": "+f.number+"N"+f.diameter,
this.b/2*c+30,h);a.strokeStyle="#AAAAAA";a.lineWidth=1;a.beginPath();a.moveTo(this.b/2*c+3,(-this.D/2+f.depth)*c);a.bezierCurveTo(this.b/2*c+15,(-this.D/2+f.depth)*c,this.b/2*c+15,h,this.b/2*c+27,h);a.stroke()}g=[];0===d[0].offset&&"highest"===d[0].from?last_depth=d[0].depth:(g.push({number:Math.floor((this.b-2*this.cover-2*this.df)/310)+2,diameter:10,depth:this.cover+this.df+5}),last_depth=g[g.length-1].depth);for(e=0;e<d.length;e++)if(h=d[e].depth-last_depth,300>h)last_depth=d[e].depth;else for(f=
Math.ceil(h/300),h/=f,k=0;k<f-1;k++)last_depth+=h,g.push({number:2,diameter:10,depth:last_depth});a.fillStyle="#CCCCCC";for(e=0;e<g.length;e++)for(f=g[e],h=(this.b-2*(this.cover+this.df)-f.diameter)/(f.number-1),k=0;k<f.number;k++)a.fillCircle((-this.b/2+this.cover+this.df+f.diameter/2+k*h)*c,(-this.D/2+f.depth)*c,f.diameter/2*c);a.restore();return"ended draw normally"};Beam.prototype.drawStressBlock=function(a){var d=a.canvas;a.setLineDash||(console.warn("Your browser isnt able to draw dashed lines :("),a.setLineDash=function(){});a.font="12px serif";a.textBaseline="top";a.textAlign="left";var c=d.height-70,e=d.width-4,g=function(a){return m/this.b*a}.bind(this),f=function(a){return l/this.D*a}.bind(this),h=this.dn,k=this.Ts_centroid_depth_from_dn(h),m=100,l=Math.max(100,Math.min(c,this.D/this.b*m)),c=f(h);f(k);a.clearRect(0,0,d.width,d.height);a.save();a.translate(2,
40);a.save();a.textBaseline="top";a.textAlign="left";a.font="15px sans-serif";a.fillStyle="grey";a.fillText("CROSS-SECTION",0,-38);a.restore();a.setLineDash([4,4,12,4]);a.beginPath();a.strokeStyle="grey";a.lineWidth=1;a.moveTo(-10,c);a.lineTo(e+10,c);a.stroke();a.fillStyle="grey";a.fillText("dn = "+h.toFixed(0)+"mm",m+5,c+2);a.setLineDash([]);CanvasPatterns.set2x2Hatch(a,"limegreen");a.fillRect(0,0,m,c*this.gamma);a.fillStyle="limegreen";a.textBaseline="bottom";a.fillText("\u0263dn = "+(h*this.gamma).toFixed(0)+
"mm",m+5,c*this.gamma-2);a.lineWidth=2;a.strokeStyle="black";a.strokeRect(0,0,m,l);for(d=0;d<this.reo.length;d++){var e=this.reo[d],k=.1*m,n=.8*m/(e.number-1),s=this.layer_strain_from_layer_dn(e,h);a.fillStyle=0<s?"red":"blue";for(var p=Math.max(2,Math.min(g(10),f(10))),t=1.8*p,q=0;q<e.number;q++)0<s?a.fillCircle(k+n*q,f(e.depth),p):a.fillRect(k+n*q-t/2,f(e.depth)-t/2,t,t)}a.translate(200,0);a.save();a.textBaseline="top";a.textAlign="center";a.font="15px sans-serif";a.fillStyle="grey";a.fillText("STRAIN DIAGRAM",
0,-38);a.restore();g=function(a,c){return c?-Math.min(.0025,Math.max(-.0025,this.strain_from_d_dn(a,h)))/.0025*60:-this.strain_from_d_dn(a,h)/.003*10}.bind(this);60<Math.abs(g(this.D))&&(g=function(a,c){if(c)return-Math.min(.0025,Math.max(-.0025,this.strain_from_d_dn(a,h)))/.0025*60;var d=this.strain_from_d_dn(a,h),e=Math.abs(this.strain_from_d_dn(this.D,h));return-d/e*60}.bind(this));CanvasPatterns.setHorizontalLine(a,"#FFC9FF");a.lineWidth=1;a.strokeStyle="magenta";a.beginPath();a.moveTo(0,0);a.lineTo(g(0),
0);a.lineTo(g(this.D),l);a.lineTo(0,l);a.fill();a.stroke();a.fillStyle="magenta";a.textAlign="left";a.textBaseline="bottom";a.fillText("\u03b5cmax = 0.003",g(0),-2);for(d=0;d<this.reo.length;d++)e=this.reo[d],k=this.layer_strain_from_layer_dn(e,h,!0),0<k?(a.strokeStyle="red",a.fillStyle="red"):(a.strokeStyle="blue",a.fillStyle="blue"),a.lineWidth=2,a.beginPath(),a.moveTo(0,f(e.depth)),a.lineTo(g(e.depth),f(e.depth)),a.stroke(),a.textAlign="left",a.textBaseline="middle",a.fillText("\u03b5s"+d+" = "+
k.toFixed(4)+(.0025<Math.abs(k)?" yield":" elast"),10,f(e.depth));a.lineWidth=2;a.strokeStyle="black";a.beginPath();a.moveTo(0,0);a.lineTo(0,l);a.stroke();a.translate(180,0);a.save();a.textBaseline="top";a.textAlign="center";a.font="15px sans-serif";a.fillStyle="grey";a.fillText("FORCE DIAGRAM",0,-38);a.restore();CanvasPatterns.set2x2Hatch(a,"limegreen");a.lineWidth=1;a.strokeStyle="limegreen";a.fillRect(0,0,50,c*this.gamma);a.strokeRect(0,0,50,c*this.gamma);a.fillStyle="limegreen";a.textAlign="center";
a.textBaseline="bottom";c=this.Cc_from_dn(h);a.fillText("Cc = "+c.toFixed(0)+"kN ("+(-this.fc*this.alpha2).toFixed(0)+"MPa)",25,-2);for(d=0;d<this.reo.length;d++)e=this.reo[d],k=this.layer_strain_from_layer_dn(e,h),c=this.layer_force_from_layer_dn(e,h),a.textBaseline="middle",0<k?(a.strokeStyle="red",a.fillStyle="red",a.textAlign="left",a.fillText("Ts"+d+" = "+c.toFixed(0)+"kN",3,f(e.depth))):(a.strokeStyle="blue",a.fillStyle="blue",a.textAlign="right",a.fillText("Cs"+d+" = "+c.toFixed(0)+"kN",-3,
f(e.depth))),a.lineWidth=2,drawArrow(a,0,f(e.depth),g(e.depth,!0),f(e.depth),6);a.lineWidth=2;a.strokeStyle="black";a.beginPath();a.moveTo(0,0);a.lineTo(0,l);a.stroke();a.restore();return"ended draw normally"};function Beam(){this.create=function(){this.eclass="A1";this.minbarspacing=void 0;this.reo=[{number:2,diameter:10,area:156,depth:40},{number:2,diameter:10,area:200,depth:560}];this.df=10;this.b=300;this.D=600;this.cover=25;this.Ln=3E3;this.fc=32;this.Ec=void 0;this.epsiloncmax=.003;this.rhoc=2400;this.fsy=500;this.Es=2E5;this.epsilonsy=this.fsy/this.Es}.bind(this);Object.defineProperty(this,"innerWidth",{get:function(){return this.b-2*(this.cover+this.df)}.bind(this)});this.get_tension_reo=function(){console.warn("check this function before use");
for(var a=[],d=this.dn,c=0;c<this.reo.length;c++)0<this.layer_strain_from_layer_dn(this.reo[c],d)&&a.push(this.reo[c]);return a}.bind(this);this.get_compression_reo=function(){console.warn("check this function before use");for(var a=[],d=this.dn,c=0;c<this.reo.length;c++)0>this.layer_strain_from_layer_dn(this.reo[c],d)&&a.push(this.reo[c]);return a}.bind(this);Object.defineProperty(this,"MuoWRONG",{get:function(){var a=this.dn,d=this.Cc_from_dn(a),c=this.Cc_centroid_depth_from_dn(a),e=this.Ts_from_dn(a),
g=this.Ts_centroid_depth_from_dn(a),f=this.Cs_from_dn(a),a=this.Cs_centroid_depth_from_dn(a);return(d*c+e*g+(f*a||0))/1E3}.bind(this)});Object.defineProperty(this,"Muo",{get:function(){for(var a=this.dn,d=this.Cc_from_dn(a)*this.Cc_centroid_depth_from_dn(a),c=0;c<this.reo.length;c++)d+=this.layer_force_from_layer_dn(this.reo[c],a)*this.reo[c].depth;return d/1E3}.bind(this)});Object.defineProperty(this,"kuo",{get:function(){return this.dn/this.d0}.bind(this)});Object.defineProperty(this,"ku",{get:function(){var a=
this.dn;return a/this.Ts_centroid_depth_from_dn(a)}.bind(this)});Object.defineProperty(this,"phi",{get:function(){return Math.max(.6,Math.min(.8,1.19-13/12*this.kuo))}.bind(this)});Object.defineProperty(this,"phiMuo",{get:function(){return this.phi*this.Muo}.bind(this)});Object.defineProperty(this,"d0",{get:function(){for(var a=-Infinity,d=0;d<this.reo.length;d++)this.reo[d].depth>a&&(a=this.reo[d].depth);return a}.bind(this)});Object.defineProperty(this,"Muo_min",{get:function(){return 1.2*this.Ze*
this.fctf/1E6}.bind(this)});Object.defineProperty(this,"Muo_min_Ast_min",{get:function(){return.2*Math.pow(this.D/this.Ts_centroid_depth,2)*this.fctf/this.fsy*this.b*this.Ts_centroid_depth}.bind(this)});Object.defineProperty(this,"dn",{get:function(){var a,d=this.D,c=0,e,g=0;do a=(d+c)/2,e=this.Ts_from_dn(a)+this.Cs_from_dn(a)+this.Cc_from_dn(a),0<e?c=a:d=a,g++;while(.05<Math.abs(e)&&50>g);return a}.bind(this)});Object.defineProperty(this,"Ts",{get:function(){return this.Ts_from_dn(this.dn)}.bind(this)});
Object.defineProperty(this,"Cs",{get:function(){return this.Cs_from_dn(this.dn)}.bind(this)});Object.defineProperty(this,"Cc",{get:function(){return this.Cc_from_dn(this.dn)}.bind(this)});this.Ts_from_dn=function(a){return this.Fs_from_dn_tension(a,!0)}.bind(this);this.Cs_from_dn=function(a){return this.Fs_from_dn_tension(a,!1)}.bind(this);this.Cc_from_dn=function(a){return-(this.b*a*this.gamma)*this.fc*this.alpha2/1E3}.bind(this);this.Fs_from_dn_tension=function(a,d){for(var c=0,e,g=0;g<this.reo.length;g++)e=
this.epsiloncmax/a*(this.reo[g].depth-a),e=d?Math.max(0,Math.min(e,this.epsilonsy)):Math.max(-this.epsilonsy,Math.min(e,0)),c+=this.reo[g].area*this.Es*e/1E3;return c}.bind(this);Object.defineProperty(this,"Ts_centroid_depth",{get:function(){return this.Ts_centroid_depth_from_dn(this.dn)}.bind(this)});Object.defineProperty(this,"d",{get:function(){return this.Ts_centroid_depth_from_dn(this.dn)}.bind(this)});Object.defineProperty(this,"Cs_centroid_depth",{get:function(){return this.Cs_centroid_depth_from_dn(this.dn)}.bind(this)});
Object.defineProperty(this,"Cc_centroid_depth",{get:function(){return this.Cc_centroid_depth_from_dn(this.dn)}.bind(this)});this.Ts_centroid_depth_from_dn=function(a){return this.Fs_centroid_from_dn_tension(a,!0)}.bind(this);this.Cs_centroid_depth_from_dn=function(a){return this.Fs_centroid_from_dn_tension(a,!1)}.bind(this);this.Cc_centroid_depth_from_dn=function(a){return this.gamma*a/2}.bind(this);this.Fs_centroid_from_dn_tension=function(a,d){for(var c,e=0,g=0,f=0;f<this.reo.length;f++)if(c=this.layer_strain_from_layer_dn(this.reo[f],
a),d&&0<c||!d&&0>c)e+=this.reo[f].area,g+=this.reo[f].area*this.reo[f].depth;return g/e||void 0}.bind(this);this.strain_from_d_dn=function(a,d){return this.epsiloncmax/d*(a-d)}.bind(this);this.layer_strain_from_layer_dn=function(a,d,c){a=this.strain_from_d_dn(a.depth,d);c||(a=Math.max(-this.epsilonsy,Math.min(a,this.epsilonsy)));return a}.bind(this);this.layer_force_from_layer_dn=function(a,d){var c=this.layer_strain_from_layer_dn(a,d,!1);return a.area*this.Es*c/1E3}.bind(this);this.layer_force_from_layer_strain=
function(a,d){return a.area*this.Es*Math.max(-this.epsilonsy,Math.min(this.epsilonsy,d))/1E3}.bind(this);this.layer_yielded_from_layer_dn=function(a,d){var c=this.layer_strain_from_layer_dn(a,d);return-.0025>=c||.0025<=c}.bind(this);Object.defineProperty(this,"As",{get:function(){var a=0;for(i=0;i<this.reo.length;i++)a+=this.reo[i].area;return a}.bind(this)});Object.defineProperty(this,"Ast",{get:function(){return this.Ast_from_dn(this.dn)}.bind(this)});Object.defineProperty(this,"Asc",{get:function(){return this.Asc_from_dn(this.dn)}.bind(this)});
Object.defineProperty(this,"Acc",{get:function(){return this.gamma*this.dn*this.b}.bind(this)});this.Ast_from_dn=function(a){return this.As_from_dn_tension(a,!0)}.bind(this);this.Asc_from_dn=function(a){return this.As_from_dn_tension(a,!1)}.bind(this);this.As_from_dn_tension=function(a,d){for(var c,e=0,g=0;g<this.reo.length;g++)if(c=this.epsiloncmax/a*(this.reo[g].depth-a),d&&0<c||!d&&0>c)e+=this.reo[g].area;return e||void 0}.bind(this);Object.defineProperty(this,"gamma",{get:function(){return Math.max(.67,
Math.min(.85,1.05-.007*this.fc))}.bind(this)});Object.defineProperty(this,"alpha2",{get:function(){return Math.max(.67,Math.min(.85,1-.003*this.fc))}.bind(this)});Object.defineProperty(this,"fctf",{get:function(){return.6*Math.sqrt(this.fc)}.bind(this)});Object.defineProperty(this,"k",{get:function(){var a=this.dn,d=this.Ts_centroid_depth_from_dn(a);return a/d}.bind(this)});Object.defineProperty(this,"Ze",{get:function(){return this.b*Math.pow(this.D,2)/6}.bind(this)});Object.defineProperty(this,
"Ixx",{get:function(){return this.b*Math.pow(this.D,3)/12}.bind(this)});this.toString=function(){return JSON.stringify(this).replace(/,/g,",\n")}.bind(this);Object.defineProperty(this,"Ag",{get:function(){return this.b*this.D}.bind(this)});Object.defineProperty(this,"p",{get:function(){return this.Ast/this.b/this.D}.bind(this)});Object.defineProperty(this,"beta",{get:function(){return this.Ast/this.b/this.D}.bind(this)});this.create()};CanvasRenderingContext2D.prototype.moveToV=function(a){this.moveTo(a.x,a.y)};CanvasRenderingContext2D.prototype.lineToV=function(a){this.lineTo(a.x,a.y)};CanvasRenderingContext2D.prototype.arrowv=function(a,d,c){this.beginPath();this.moveTo(a.x,a.y);this.lineTo(d.x,d.y);this.stroke();a=Math.atan2(d.y-a.y,d.x-a.x);this.save();this.translate(d.x,d.y);this.rotate(a-Math.PI/2);this.beginPath();this.moveTo(-.3*c,-1*c);this.lineTo(0,0);this.lineTo(.3*c,-1*c);this.stroke();this.restore()};
CanvasRenderingContext2D.prototype.arrow=function(a,d,c,e,g){this.beginPath();this.moveTo(a,d);this.lineTo(c,e);this.stroke();a=Math.atan2(e-d,c-a);this.save();this.translate(c,e);this.rotate(a-Math.PI/2);this.beginPath();this.moveTo(-.3*g,-1*g);this.lineTo(0,0);this.lineTo(.3*g,-1*g);this.stroke();this.restore()};CanvasRenderingContext2D.prototype.circle=function(a,d,c){this.arc(a,d,Math.max(0,c),0,2*Math.PI)};
CanvasRenderingContext2D.prototype.fillCircle=function(a,d,c){this.beginPath();this.circle(a,d,c);this.fill()};CanvasRenderingContext2D.prototype.strokeCircle=function(a,d,c){this.beginPath();this.circle(a,d,c);this.stroke()};CanvasRenderingContext2D.prototype.fillStrokeCircle=function(a,d,c){this.beginPath();this.circle(a,d,c);this.fill();this.stroke()};
CanvasRenderingContext2D.prototype.sharpLine=function(a,d,c,e,g,f,h,k){a=Math.round(a);d=Math.round(d);c=Math.round(c);e=Math.round(e);for(var m=this.getImageData(0,0,this.canvas.width,this.canvas.height),l,n=Math.abs(c-a),s=a<c?1:-1,p=Math.abs(e-d),t=d<e?1:-1,q=(n>p?n:-p)/2;;){l=4*a+4*this.canvas.width*d;m.data[l+0]=g;m.data[l+1]=f;m.data[l+2]=h;m.data[l+3]=k;if(a===c&&d===e)break;l=q;l>-n&&(q-=p,a+=s);l<p&&(q+=n,d+=t)}this.putImageData(m,0,0)};
CanvasRenderingContext2D.prototype.sharpLineV=function(a,d,c,e,g,f){this.sharpLine(a.x,a.y,d.x,d.y,c,e,g,f)};CanvasRenderingContext2D.prototype.setPixel=function(a,d,c,e,g,f){var h=this.getImageData(0,0,this.canvas.width,this.canvas.height);a=4*a+4*this.canvas.width*d;h.data[a+0]=c;h.data[a+1]=e;h.data[a+2]=g;h.data[a+3]=f;this.putImageData(h,0,0)};CanvasPatterns=new function(){this.set2x2Hatch=function(a,d){var c=document.createElement("canvas"),e=c.getContext("2d");c.width=2;c.height=2;e.fillStyle=d;e.fillRect(0,0,1,1);e.fillRect(0,1,1,1);a.fillStyle=a.createPattern(c,"repeat")};this.setHorizontalLine=function(a,d){var c=document.createElement("canvas"),e=c.getContext("2d");c.width=1;c.height=6;e.fillStyle=d;e.fillRect(0,0,1,1);a.fillStyle=a.createPattern(c,"repeat")}};function CalcDiv(){EventDispatcher.call(this);this.contentdiv=this.topdiv=this.body=null;this._collapsed=!1;this.init=function(){this.body=this.body||document.createElement("div");this.body.innerHTML='<div class="CalcDiv">\r\n\t\t\t<table class="topdiv">\r\n\t\t\t\t<tr>\r\n\t\t\t\t\t<td style="width:30px;padding-right:10px;">\r\n\t\t\t\t\t\t<button class="minmaxbutton" title="Show workings.">+</button>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td class="titlediv">\r\n\t\t\t\t\t\t[Title]\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</table>\r\n\t\t\t<div class="contentdiv" style="display: none;">\r\n\t\t\t\t<p>[Content]</p>\r\n\t\t\t</div>\r\n\t\t</div>';
this.topdiv=this.body.querySelector(".topdiv");this.minmaxbutton=this.body.querySelector(".minmaxbutton");this.titlediv=this.body.querySelector(".titlediv");this.contentdiv=this.body.querySelector(".contentdiv");this._collapsed=!0;this.dispatch("init",null)}.bind(this);this.appendTo=function(a){this.init();a.appendChild(this.body);this.topdiv.addEventListener("click",this.toggleCollapse,!1);this.dispatch("added")}.bind(this);this.toggleCollapse=function(){this.collapsed=!this.collapsed}.bind(this);
this.updateMathJax=function(){MathJax.Hub.Queue(["Typeset",MathJax.Hub,this.body])}.bind(this);Object.defineProperty(this,"collapsed",{get:function(){return this._collapsed}.bind(this),set:function(a){this._collapsed=a;this.contentdiv.style.display=a?"none":"";a?(this.minmaxbutton.innerHTML="+",this.dispatch("hide")):(this.minmaxbutton.innerHTML="-",this.dispatch("show"))}.bind(this)});Object.defineProperty(this,"title",{get:function(){return this.titlediv.innerHTML}.bind(this),set:function(a){this.titlediv.innerHTML=
a}.bind(this)});Object.defineProperty(this,"content",{get:function(){return this.contentdiv.innerHTML}.bind(this),set:function(a){this.contentdiv.innerHTML=a}.bind(this)});this.addParagraph=function(a){var d=document.createElement("p");d.innerHTML=a;this.contentdiv.appendChild(d)}.bind(this);this.addSpace=function(){var a=document.createElement("div");a.style.height="5px";this.contentdiv.appendChild(a)}.bind(this);this.addElement=function(a){this.contentdiv.appendChild(a)}.bind(this);this.init()}
;function EventDispatcher(){1!=this.__isEventDispatcher&&(this.__isEventDispatcher=!0,this.__events={},this.on=function(a,d){"string"!==typeof a||"function"!==typeof d?console.log("Invalid event registration, "+a):(void 0===this.__events[a]&&(this.__events[a]=[]),this.__events[a].push(d))}.bind(this),this.clearListeners=function(a){void 0!==this.__events[a]&&(this.__events[a]=[])}.bind(this),this.dispatch=function(a,d){if(void 0!==this.__events[a])for(var c=0;c<this.__events[a].length;c++)this.__events[a][c](d)}.bind(this))}
;function dim(a,d,c,e,g,f,h,k){a.save();a.font="15px serif";a.textBaseline="middle";a.textAlign="center";var m=a.measureText(k);d=new Vector(d,c);e=new Vector(e,g);var l=(new Vector).fromAngLen(f,Math.max(10,Math.abs(h),m.width/2*Math.cos(f)+5)*h/Math.abs(h));g=d.copy().add(l);c=(new Vector).fromAngLen(f+Math.PI/2,1).dot(e.copy().minus(d));c=g.copy().add((new Vector).fromAngLen(f+Math.PI/2,1).scalar(c));l=g.copy().add(c).scalar(.5);30>g.copy().minus(c).len&&(l=(new Vector).fromAngLen(f,Math.max(10,
Math.abs(h))*h/Math.abs(h)),g=d.copy().add(l),c=(new Vector).fromAngLen(f+Math.PI/2,1).dot(e.copy().minus(d)),c=g.copy().add((new Vector).fromAngLen(f+Math.PI/2,1).scalar(c)),l=g.copy().add(c).scalar(.5).add(l.unit().scalar(m.width/2+5)));f=c.copy().minus(g).ang;a.lineWidth=1;a.strokeStyle="#555555";a.fillStyle="#555555";a.beginPath();h=g.copy().minus(d).unit().scalar(4).add(d);d=g.copy().minus(d).unit().scalar(4).add(g);a.moveTo(h.x,h.y);a.lineTo(d.x,d.y);h=c.copy().minus(e).unit().scalar(4).add(e);
d=c.copy().minus(e).unit().scalar(4).add(c);a.moveTo(h.x,h.y);a.lineTo(d.x,d.y);a.moveTo(g.x,g.y);a.lineTo(c.x,c.y);a.stroke();a.save();a.translate(g.x,g.y);a.rotate(f-Math.PI/2);a.beginPath();a.moveTo(0,0);a.lineTo(2,5);a.lineTo(-2,5);a.fill();a.restore();a.save();a.translate(c.x,c.y);a.rotate(f+Math.PI/2);a.moveTo(0,0);a.lineTo(2,5);a.lineTo(-2,5);a.fill();a.restore();k&&""!==k&&(a.fillStyle="#000000",a.clearRect(l.x-m.width/2-3,l.y-7.5-1,m.width+6,19),a.fillText(k,l.x,l.y));a.restore()};function drawArrow(a,d,c,e,g,f){var h=e-d,k=g-c,m=Math.sqrt(h*h+k*k),h=h/m*(m-f+1)+d,k=k/m*(m-f+1)+c;f=Math.min(f,m/2);a.beginPath();a.moveTo(d,c);a.lineTo(h,k);a.stroke();a.save();a.translate(e,g);a.rotate(Math.atan2(g-c,e-d)+Math.PI/2);a.beginPath();a.moveTo(0,0);a.lineTo(f/2,f);a.lineTo(-f/2,f);a.fill();a.stroke();a.restore()};function drawFitment(a,d,c,e,g,f,h,k){function m(){a.beginPath();a.moveTo(d+e-f-f/Math.SQRT2-h,c+f-f/Math.SQRT2+h);a.arc(d+e-f,c+f,f,1.5*Math.PI-Math.PI/4,2*Math.PI);a.moveTo(d+e,c+g-f);a.lineTo(d+e,c+f);a.arc(d+e-f,c+g-f,f,0,Math.PI/2);a.lineTo(d+e-3*f,c+g);a.moveTo(d+e-f,c+g);a.lineTo(d+f,c+g);a.arc(d+f,c+g-f,f,Math.PI/2,Math.PI);a.moveTo(d,c+g-f);a.lineTo(d,c+f);a.arc(d+f,c+f,f,Math.PI,1.5*Math.PI);a.moveTo(d+f,c);a.lineTo(d+e-f,c);a.arc(d+e-f,c+f,f,-Math.PI/2,Math.PI/4);a.lineTo(d+e-f+f/Math.SQRT2-
h,c+f+f/Math.SQRT2+h);a.stroke()}3<=k?(a.lineCap="square",a.strokeStyle="black",a.lineWidth=Math.ceil(k),m(),a.lineCap="square",a.strokeStyle="white",a.lineWidth=Math.ceil(k)-2):(a.lineCap="square",a.strokeStyle="black",a.lineWidth=k);m()};function HelpBar(a){this.host=document.getElementById(a);this.data=null;this.startload=function(){tinyxhr("infos/infos.json",function(a,c,e){if(a&&!c)throw console.log("Failed to load help bar json content"),a;this.data=JSON.parse(c);this.init()}.bind(this));"onhashchange"in window?window.addEventListener("hashchange",this.hashChangeListener,!1):(this.prevHash=window.location.hash,window.setInterval(function(){window.location.hash!=this.prevHash&&(this.prevHash=window.location.hash,this.hashChangeListener(this.prevHash))}.bind(this),
100))}.bind(this);this.init=function(){this.buildBar();try{MathJax.Hub.Queue(["Typeset",MathJax.Hub])}catch(a){console.log("Failed to typeset help bar",a)}ttips.grab(this.host)}.bind(this);this.buildBar=function(){function a(c){var d="";c.id&&(d+='<a href="#help_bar_'+c.id+'">');d+='<table class="help_bar_link" data-tooltip="'+c.description+'"><tr>';d+='<td class="c1">$$$'+c.notation+'$$$</td><td class="c2">'+c.name+"</td>";d+="</tr></table>";c.id&&(d+="</a>");return d}function c(c,f){var h=e("help_bar_"+
c.id,"helpblock"),g;g='<a href="#help_block_index" style="display:block;line-height:40px;height:40px;text-align:center;">Back to Help Index.</a>'+("<h1>"+(c.notation?"$$$"+c.notation+"$$$ ":"")+c.name+(c.unit?" ("+c.unit+")":"")+"</h1>");c.description&&(g+="<p><b>"+c.description+"</b></p>");g+=c.docs;if(0<c.coderef.length){g+='<table class="help_bar_coderef">';for(var k=0;k<c.coderef.length;k++)g+='<tr><td class="c1">'+c.coderef[k].ref+'</td><td class="c2">'+c.coderef[k].data+"</td></tr>";g+="</table>"}if(0<
c.related.length)for(g+="<h2>Related:</h2>",c.related.sort(),k=0;k<c.related.length;k++)try{g+=a(f[c.related[k]])}catch(t){g+=a({id:"",notation:"",name:c.related[k]})}h.innerHTML=g;h.style.display="none";return h}function e(a,c){var d=document.createElement("div");d.id=a||"";d.className=c||"";return d}var g=e("help_bar_index","helpblock");this.host.appendChild(g);var f=[],h;for(h in this.data)f.push(this.data[h]);f.sort(function(a,c){return a.unicode.localeCompare(c.unicode)});h="<div><h1>Help Index</h1>";
for(var k=0;k<f.length;k++)this.host.appendChild(c(f[k],this.data)),h+=a(f[k]);g.innerHTML=h+"</div>"}.bind(this);this.hideAll=function(){for(var a=this.host.children,c=0;c<a.length;c++)a[c].style.display="none"}.bind(this);this.hashChangeListener=function(a){var c=void 0;if("string"===typeof a)c=a.split("#")[1];else try{c=a.newURL.split("#")[1]}catch(e){c=window.location.hash.split("#")[1]}this.hideAll();if(c)(a=this.host.querySelector("#"+c))?a.style.display="":this.host.querySelector("#help_bar_index");
else if(a=this.host.querySelector("#help_bar_index"))a.style.display=""}.bind(this);window.open("#","_self");this.startload()};var vin={};vin.b=new VarInput("b","$$$b$$$","number",300,"mm");vin.D=new VarInput("Depth","$$$D$$$","number",600,"mm");vin.cover=new VarInput("cover","Cover","number",25,"mm");vin.df=new VarInput("dfitments","$$$d_f$$$","number",10,"mm",[10,12,13,14,15,15,17,18,19,20]);vin.eclass=new VarInput("eclass","E. Class","text","A1","","A1 A2 B1 B2 C1 C2".split(" "));vin.fc=new VarInput("fc","$$$f'_c$$$","number",32,"MPa",[20,25,32,40,50,65,80,100]);
for(var i in vin)vin[i].appendTo(document.querySelector("#invardiv-content")),vin[i].on("change",function(){mainUpdateListener()});
vin.b.validate=function(a){void 0==a.value||null==a.value||isNaN(a.value)?a.warning.push('<a href="#help_bar_b">b</a>  Should not be left blank.'):0!==a.value%5&&a.error.push('<a href="#help_bar_b">b</a>  should be rounded to nearest 5mm.');150>a.value&&a.error.push('<a href="#help_bar_b">b</a>  is too small. Beams should be at least '+"150mm".bold()+" wide for this software to work.");2E3<a.value&&a.error.push('<a href="#help_bar_b">b</a>  is too large. Beams should be at most '+"2000mm".bold()+
" wide for this software to work.");return a};
vin.D.validate=function(a){void 0==a.value||null==a.value||isNaN(a.value)?a.warning.push('<a href="#help_bar_Depth">D</a>  Should not be left blank.'):0!==a.value%5&&a.error.push('<a href="#help_bar_Depth">D</a>  should be rounded to nearest 5 mm.');150>a.value&&a.error.push('<a href="#help_bar_Depth">D</a>  is too small. Beams  should be at least '+"150 mm".bold()+" deep for this software to work.");1500<a.value&&a.error.push('<a href="#help_bar_Depth">D</a> Beam too deep. Beams should be at most '+"2000 mm".bold()+
" deep for this software to work.");return a};
vin.cover.validate=function(a){if(void 0==a.value||null==a.value||isNaN(a.value))a.warning.push('<a href="#help_bar_cover">Cover</a> Should not be left blank.');else if(150<a.value)a.warning.push('<a href="#help_bar_cover">Cover</a> might be too big... unless there is a special reason.');else if(20>a.value)a.error.push('<a href="#help_bar_cover">Cover</a> is too small'),a.value=20;else{0!==a.value%5&&a.error.push('<a href="#help_bar_cover">Cover</a> should be rounded to nearest 5 mm.');var d=AS3600["4.10.3.2"].get_min_cover_from_fc_eclass(vin.fc.value,
vin.eclass.value);void 0!==d&&a.value<d&&a.error.push('<a href="#help_bar_cover">Cover</a> insufficient for <a href="#help_bar_fc">f\'c</a> and <a href="#help_bar_eclass">Exposure Classification</a>. See AS3600 4.10.3.2: The minimum cover without special provisions is: '+(d+" mm").bold())}return a};
vin.fc.validate=function(a){var d=AS3600["4.10.3.2"].get_min_fc_from_eclass(vin.eclass.value),c=AS3600["4.10.3.2"].get_max_eclass_from_fc(vin.fc.value);void 0!==d&&a.value<d&&a.error.push('<a href="#help_bar_fc">f\'c</a> is too small for <a href="#help_bar_eclass">Exposure Classification</a>. See AS3600 4.10.3.2:<br>The minimum fc without special provisions is: '+(d+" MPa").bold()+'<br>Alternatively, reduce <a href="#help_bar_eclass">Exposure Classification</a> to '+String(c).bold());return a};var calcs={};
function outputCalculations(){var a=document.querySelector("#calcdiv-content");a.innerHTML="";var d=b.dn;calc.alpha2.update();calc.alpha2.appendTo(a);calc.dn.update();calc.dn.appendTo(a);calcs.d=calcs.d||new CalcDiv;calcs.d.title="$$$d ~~=~~ "+b.d.toFixed(0)+"~ mm $$$";calcs.d.content="";calcs.d.addParagraph("d is the depth to the <b>centroid of the tension steel</b> from the upper surface of the beam.");calcs.d.addParagraph("$$ \\sum{d_i \\times A_{st i}}\\over\\sum{A_{st i}} $$");calcs.d.addParagraph("<b>Note:</b> The 'top' reo layer may or may not be in tension! <i>Be sure to check that you assume correctly in hand calculations</i>. (Once you have calculated Depth to Neutral Axis (dn), all layers below dn are in tension.)");for(var c=
"",e="",g=0,f="",h="",k=0,m=[],l=0;l<b.reo.length;l++)0>=b.layer_strain_from_layer_dn(b.reo[l],d)?m.push(l):(c+="d_"+l+" A_{st "+l+"}",e+=b.reo[l].depth.toFixed(0)+" \\times "+b.reo[l].area.toFixed(0),g+=b.reo[l].depth*b.reo[l].area,f+="A_{st "+l+"}",h+=b.reo[l].area+"",k+=b.reo[l].area,l!=b.reo.length-1&&(c+="~+~",e+="~+~",f+="~+~",h+="~+~"));calcs.d.addParagraph("$$\\begin{aligned} d &= {{"+c+"}\\over{"+f+"}} \\\\ &= {{"+e+"}\\over{"+h+"}}\\\\ &= {{"+(g/k).toFixed(0)+"}}mm\\end{aligned}$$");m.length&&
calcs.d.addParagraph("<b>Note:</b> layers  <b>"+m.join(", ")+"</b> are compressive and have been excluded.");calcs.d.appendTo(a);calcs.dn=calcs.dn||new CalcDiv;calcs.dn.appendTo(a);calcs.dn.title="$$$d_n ~~=~~ "+b.dn.toFixed(0)+"~ mm $$$";calcs.dn.content="";calcs.dn.addParagraph("Depth to neutral axis ($$$d_n$$$) is calculated by the 'Rectangular Stress Block' Method. This involves solving the internal horizontal forces in the beam:");calcs.dn.addParagraph("$$\\sum F_x = C_c + C_s + (-T_s) = 0$$");
calcs.dn.addParagraph("Where...");calcs.dn.addParagraph("$$\\begin{aligned} C_{concrete} &= \\alpha_2 f'_c \\times (b)(\\gamma d_n) \\\\ T_{steel} &= E_s \\sum(\\epsilon_{s i} A_{s i}) &\\text{for tensile steel layers}\\\\C_{steel} &= E_s \\sum(\\epsilon_{s i} A_{s i}) &\\text{for compressive steel layers}\\end{aligned}$$");calcs.howtoknowtension=calcs.howtoknowtension||new CalcDiv;calcs.howtoknowtension.appendTo(calcs.dn.contentdiv);calcs.howtoknowtension.title="How to tell if a layer is in tension/compression?";
calcs.howtoknowtension.addParagraph("When a beam has multiple layers of reinforcement, it is sometimes unclear which layers are in tension or compression. The only way to know is to 'guess and check' which layers are in tension/compression.");calcs.howtoknowtension.addParagraph("If you get the guess wrong, the sum of horizontal forces equation below will have non-nonsensical or no solutions. This is because a force balance does not exist for an incorrect guess.");calcs.howtoknowtension.addParagraph("This software finds d_n by the same force equilibrium equation but uses a blind guess and check 'bisection' solver to find the root of  $$$F_x(d_n) = 0$$$.");
calcs.dn.addParagraph("Where...");calcs.esi=calcs.esi||new CalcDiv;calcs.esi.content="";calcs.esi.appendTo(calcs.dn.contentdiv);calcs.esi.title="$$$\\epsilon_{si} = 0.003 ({{d_i}/{d_n}} - 1)$$$";calcs.esi.addParagraph("$$$\\epsilon_{si}$$$ is the strain of each layer of steel.");calcs.esi.addParagraph("It is calculated by similar triangles from the following diagram.");calcs.dn.addParagraph("$$$A_{si}$$$ =  the sectional area of each layer of steel ($$$mm^2$$$)");calcs.dn.addParagraph("$$$E_{si}$$$ =  the young's modulus of the steel (200,000 MPa)");
calcs.dn.addParagraph("For this beam, the full equations are as follows:");c=[];e=[];g=[];f=[];for(l=0;l<b.reo.length;l++)0>=b.layer_strain_from_layer_dn(b.reo[l],d)?(h="0.003("+b.reo[l].depth.toFixed(0)+"/{d_n} - 1)",e.push("["+h+"]\\times"+b.reo[l].area.toFixed(0)),h="0.003(d_{"+l+"}+/{d_n} - 1)",f.push("["+h+"]\\times A_{s"+l+"}")):(h="0.003("+b.reo[l].depth.toFixed(0)+"/{d_n} - 1)",c.push("["+h+"]\\times"+b.reo[l].area.toFixed(0)),h="0.003(d_{"+l+"}/{d_n} - 1)",g.push("["+h+"]\\times A_{s"+l+
"}"));d=[];d.push("C_c &= (\\alpha_2 f_c)(b \\times \\gamma d_n)");d.push("T_s &= E_s \\times ("+(0<g.length?g.join("+"):"0")+")");d.push("C_s &= E_s \\times ("+(0<f.length?f.join("+"):"0")+")");calcs.dn.addParagraph("$$\\begin{aligned}"+d.join("\\\\")+"\\end{aligned}$$");calcs.dn.addParagraph("Substituting in all the known values:");d=[];d.push("C_c &= ("+b.alpha2.toFixed(2)+"\\times"+b.fc.toFixed(0)+")("+b.b.toFixed(0)+"\\times"+b.gamma.toFixed(2)+" d_n)");d.push("T_s &= "+b.Es+" \\times ("+(0<
c.length?c.join("+"):"0")+")");d.push("C_s &= "+b.Es+" \\times ("+(0<e.length?e.join("+"):"0")+")");calcs.dn.addParagraph("$$\\begin{aligned}"+d.join("\\\\")+"\\end{aligned}$$");calcs.dn.addParagraph("These equations are now all in terms of $$$d_n$$$. This software can't simplify them for you, but they should end up as some kind of quadratic equation when subsituted back into");calcs.dn.addParagraph("$$\\sum F_x = C_c + C_s + (-T_s) = 0$$");calcs.Muo=calcs.Muo||new CalcDiv;calcs.Muo.appendTo(a);calcs.Muo.title=
"$$$M_{uo} ~~=~~ "+b.Muo.toFixed(1)+" ~kNm $$$";calcs.Muo.addParagraph("");calcs.Muo.addParagraph("");calcs.kuo=calcs.kuo||new CalcDiv;calcs.kuo.appendTo(a);calcs.kuo.title="$$$k_{uo} ~~=~~  $$$";calcs.kuo.addParagraph("");calcs.kuo.addParagraph("");calcs.phi=calcs.phi||new CalcDiv;calcs.phi.appendTo(a);calcs.phi.title="$$$\\Phi ~~=~~ $$$";calcs.phi.addParagraph("");calcs.phi.addParagraph("");calcs.capacity=calcs.capacity||new CalcDiv;calcs.capacity.appendTo(a);calcs.capacity.title="$$$\\Phi M_{uo} ~~=~~  ~kNm$$$ (Capacity)";
calcs.capacity.addParagraph("");calcs.capacity.addParagraph("");MathJax.Hub.Queue(["Typeset",MathJax.Hub,a])};var helpBar=new HelpBar("varinfodiv"),ttips=new ProTips(document.querySelector("#protips"));ttips.add(vin.b.body,"Breadth or Width of beam.");ttips.add(vin.D.body,"Depth or height of beam.");ttips.add(vin.cover.body,"Distance from outer surface to the steel embedded in the beam.");ttips.add(vin.eclass.body,"Exposure Classification. A designation of the harshness of the beam's enviroment. <b>See AS3600 Table 4.3</b>");ttips.add(vin.df.body,"Diameter of 'fitments' which make up the 'ribcage' of the beam. This software uses <b>Standard Round Bar Diameters</b>");
ttips.add(vin.fc.body,"The concrete strength (standard grades only. See AS3600 3.1.1.1)");var b=new Beam,rman=new ReoManager(document.querySelector("#reorows"),b);rman.on("change",mainUpdateListener);var cs_canvas=document.querySelector("#crosssectioncanvas"),cs_ctx=cs_canvas.getContext("2d");rman.rows[0].barcode="3N32";rman.rows[2].from="highest";rman.rows[3].from="highest";ttips.grab(document.body);mainUpdateListener();
function mainUpdateListener(a){intakeBeamValues();document.querySelector("#reosumarea").innerHTML=b.As||"";b.drawStressBlock(document.querySelector(".dncanvas").getContext("2d"));collapseCalcs();flagCalcsForUpdate();b.drawSection(cs_ctx);updateErrorOutput()}
function updateErrorOutput(){var a=[],d=[],c;for(c in vin)var e=vin[c].getValidity(),a=a.concat(e.error),d=d.concat(e.warning);var g=rman.getEnabledRows();for(c=0;c<g.length;c++)e=g[c].getValidity(b.dn),a=a.concat(e.error),d=d.concat(e.warning);.1>b.kuo?a.push('<a href="#help_bar_kuo">k<sub>uo</sub></a> &lt;0.1 The beam may be under-reinforced. See calculations below.'):.36<b.kuo&&a.push('<a href="#help_bar_kuo">k<sub>uo</sub></a> &gt;0.36 The beam may be over-reinforced. See calculations below. See AS3600 8.1.5');
b.Muo<b.Muo_min&&a.push('<a href="#help_bar_Muo">M<sub>uo</sub></a> &lt; <a href="#help_bar_Muo_min">(M<sub>uo</sub>)<sub>min</sub></a> ( '+b.Muo.toFixed(0)+"kNm < "+b.Muo_min.toFixed(0)+"kNm). See AS3600 8.6.1.");ttips.setError(a,d)}
function intakeBeamValues(){b.b=Math.max(150,vin.b.value)||200;b.D=Math.max(150,vin.D.value)||300;b.cover=Math.max(5,vin.cover.value);b.eclass=vin.eclass.value;b.df=vin.df.value;b.fc=vin.fc.value;b.reo=rman.value;for(var a in vin)vin[a].update_validity();for(a in rman.rows)rman.rows[a].update_validity()}var calculationdiv=document.querySelector("#calcdiv-content");initCalcs(calculationdiv);
function initCalcs(a){calc.alpha2.appendTo(a);calc.dn.appendTo(a);calc.Muo.appendTo(a);calc.kuo.appendTo(a);calc.phi.appendTo(a);calc.phiMuo.appendTo(a);calc.checks.appendTo(a)}var calc_update_timeout_id=null;function flagCalcsForUpdate(){clearTimeout(calc_update_timeout_id);calc_update_timeout_id=setTimeout(updateCalculations,500)}
function updateCalculations(){calc_update_timeout_id=null;calc.alpha2.updateTitle();calc.dn.updateTitle();calc.Muo.updateTitle();calc.kuo.updateTitle();calc.phi.updateTitle();calc.phiMuo.updateTitle();calc.checks.updateTitle()}function collapseCalcs(){calc.alpha2.collapsed=!0;calc.dn.collapsed=!0;calc.Muo.collapsed=!0;calc.kuo.collapsed=!0;calc.phi.collapsed=!0;calc.phiMuo.collapsed=!0;calc.checks.collapsed=!0}
function printcalcs(){var a=window.open("","_blank","width=1500,height=700, top=100,left=100");a.document.write('<link rel="stylesheet" href="style/index.css" type="text/css">');a.document.write('<div style="width:100%;">BEAMCALCS:</div><hr />');for(var d=document.querySelectorAll("canvas"),c=0;c<d.length;c++){var e=a.document.createElement("img");e.src=d[c].toDataURL();a.document.body.appendChild(e);e.style.marginLeft="auto";e.style.marginRight="auto";e.style.display="block"}d=a.document.createElement("div");
a.document.body.appendChild(d);a.document.body.style.width="calc(100% - 1cm)";a.document.body.style.margin="0.5cm";a.document.body.style.display="block";a.document.body.style.background="white";calc.alpha2.appendTo(d);calc.dn.appendTo(d);calc.Muo.appendTo(d);calc.kuo.appendTo(d);calc.phi.appendTo(d);calc.phiMuo.appendTo(d);calc.checks.appendTo(d);calc.alpha2.collapsed=!1;calc.dn.collapsed=!1;calc.Muo.collapsed=!1;calc.kuo.collapsed=!1;calc.phi.collapsed=!1;calc.phiMuo.collapsed=!1;calc.checks.collapsed=
!1;MathJax.Hub.Queue(function(){a.print();initCalcs(calculationdiv)})};function ProTips(a){this.body=a;this.tips_div=this.body.querySelector(".tips");this.feedback_div=this.body.querySelector(".feedback");this.tips=[];this.add=function(a,c){this.tips.push({target:a,tip:c});a.addEventListener("mouseover",this.over);a.addEventListener("mouseout",this.out)}.bind(this);this.addElemSelector=function(a,c,e){a=a.querySelectorAll(c);for(c=0;c<a.length;c++)this.add(a[c],e)}.bind(this);this.tip_from_target=function(a){for(var c=0;c<this.tips.length;c++)if(this.tips[c].target===
a)return this.tips[c].tip}.bind(this);this.over=function(a){this.tips_div.style.color="black";for(a=a.target;void 0===this.tip_from_target(a)&&a!==document.body;)a=a.parentElement;this.tips_div.innerHTML=this.tip_from_target(a)}.bind(this);this.out=function(a){this.tips_div.style.color="lightgrey";this.tips_div.innerHTML="Roll your mouse over something to get a tooltip here!"}.bind(this);this.grab=function(a){try{var c=a.querySelectorAll("*")}catch(e){console.log("protips could not grab from "+a);
return}for(a=0;a<c.length;a++)c[a].getAttribute("data-tooltip")&&this.add(c[a],c[a].getAttribute("data-tooltip"))}.bind(this);this.setError=function(a,c){var e="";a&&0<a.length&&(e+='<ul class="errorlist"><li>'+a.join("</li><li>")+"</li></ul>");c&&0<c.length&&(e+='<ul class="warninglist"><li>'+c.join("</li><li>")+"</li></ul>");this.feedback_div.innerHTML=e;this.feedback_div.style.backgroundColor=0<a.length+c.length?"yellow":""}.bind(this);this.updateMathJax=function(){if(document.body.contains(this.body))try{MathJax.Hub.Queue(["Typeset",
MathJax.Hub,this.body])}catch(a){}}.bind(this)};function ReoInput(a){this.manager=a;EventDispatcher.call(this);this.diameters=[10,12,16,20,24,28,32,36,40];this.areas=[78,113,201,314,452,616,804,1020,1260];this.masses=[.632,.91,1.619,2.528,3.64,4.955,6.471,8.91,10.112];this._isFirstRow=!1;this.create=function(){this.body=document.createElement("tr");this.body.className="reoinput";this.body.innerHTML='\r\n\t\t<td class="layernum">#</td>\r\n\t\t<td><input type="checkbox" class="enabled"></td>\r\n\t\t<td style="white-space:nowrap;"><input class="barcode" required value="2N10"/> <span class="offmessage" style="display:none;color:lightgrey;">&#8592; Click here to add a new row</span></td>\r\n\t\t<td><button class="more" tabindex="-1">+</button><button class="less" tabindex="-1">-</button></td>\r\n\t\t<td><select class="from"><option value="highest">&#8593; Top</option><option value="lowest" selected>&#8595; Bottom</option></select></td>\r\n\t\t<td><input type="number" class="offset" value="0" required/></td>\r\n\t\t\r\n\t\t<td class="area">--</td>\r\n\t\t<td class="depth">0</td>\r\n\t\t';
this.enabledCheckbox=this.body.querySelector(".enabled");this.barcodeInput=this.body.querySelector(".barcode");this.moreButton=this.body.querySelector(".more");this.lessButton=this.body.querySelector(".less");this.areaOutput=this.body.querySelector(".area");this.layerNumberOutput=this.body.querySelector(".layernum");this.layerNumberOutput.style.fontWeight="bold";this.layerDepthOutput=this.body.querySelector(".depth");this.offsetInput=this.body.querySelector(".offset");this.fromInput=this.body.querySelector(".from");
this.selectedCheckbox=this.body.querySelector(".selected");this.offMessageOutput=this.body.querySelector(".offmessage");this.enabled=!1}.bind(this);this.appendTo=function(a){a.appendChild(this.body);this.enabledCheckbox.addEventListener("change",function(a){this.enabled=this.enabledCheckbox.checked;this.change()}.bind(this));this.moreButton.addEventListener("click",function(){this.more();this.update();this.change()}.bind(this));this.lessButton.addEventListener("click",function(){this.less();this.update();
this.change()}.bind(this));this.offsetInput.addEventListener("change",function(){this.update();this.change()}.bind(this));this.offsetInput.addEventListener("input",function(){this.update();this.change()}.bind(this));this.fromInput.addEventListener("change",function(){this.update();this.change()}.bind(this));this.barcodeInput.addEventListener("keydown",function(a){38==a.keyCode&&(this.more(),a.preventDefault(),this.update(),this.change());40==a.keyCode&&(this.less(),a.preventDefault(),this.update(),
this.change())}.bind(this));this.barcodeInput.addEventListener("change",function(){this.update();this.change()}.bind(this));this.barcodeInput.addEventListener("input",function(a){for(var d=a.target.value,g=a.target.selectionStart,f=a.target.selectionEnd,d=d.split(""),h=0;h<d.length;h++)/[^0-9nN]/.test(d[h])&&(d.splice(h--,1),h<g&&(g--,f=g));d=d.join("");d=d.toUpperCase();a.target.value=d;a.target.setSelectionRange(g,f);this.update();this.change()}.bind(this))}.bind(this);Object.defineProperty(this,
"enabled",{get:function(){return this.enabledCheckbox.checked}.bind(this),set:function(a){this.enabledCheckbox.checked=a;this.barcodeInput.disabled=!a;this.moreButton.disabled=!a;this.lessButton.disabled=!a;this.areaOutput.disabled=!a;this.offsetInput.disabled=!a;this.fromInput.disabled=!a;this.update()}.bind(this)});Object.defineProperty(this,"barcode",{get:function(){var a=this.barcodeInput.value;return a.match(/^([0-9]+)(N)([0-9]+)$/)?a:""}.bind(this),set:function(a){this.barcodeInput.value=a;
this.update()}.bind(this)});Object.defineProperty(this,"area",{get:function(){return this.areas[this.diameters.indexOf(this.diameter)]*this.number||void 0}.bind(this)});Object.defineProperty(this,"mass_per_meter",{get:function(){return this.masses[this.diameters.indexOf(this.diameter)]*this.number||void 0}.bind(this)});Object.defineProperty(this,"diameter",{get:function(){return parseInt(this.barcode.split("N")[1])||10}.bind(this),set:function(a){-1!==this.diameters.indexOf(a)?this.barcode=this.number+
"N"+a:console.warn("Invalid assignment to reo-input diameter: "+a)}.bind(this)});Object.defineProperty(this,"number",{get:function(){return parseInt(this.barcode.split("N")[0])||2}.bind(this),set:function(a){"number"==typeof a&&!isNaN(a)&&void 0!==a&&2<=a&&100>a?this.barcode=a+"N"+this.diameter:console.warn("Invalid assignment to reo-input number: "+a)}.bind(this)});Object.defineProperty(this,"offset",{get:function(){return parseInt(this.offsetInput.value)||0}.bind(this),set:function(a){this.offsetInput.value=
Math.abs(Math.round(parseFloat(a)))}.bind(this)});Object.defineProperty(this,"from",{get:function(){return this.fromInput.value}.bind(this),set:function(a){this.fromInput.value=a;this.update()}.bind(this)});Object.defineProperty(this,"isAtHighestPosition",{get:function(){return this.isHighestHighestRow&&0===this.offset}.bind(this)});Object.defineProperty(this,"isAtLowestPosition",{get:function(){return this.isLowestLowestRow&&0===this.offset}.bind(this)});Object.defineProperty(this,"isHighestHighestRow",
{get:function(){return this.manager.getHighestHighestRow()===this}.bind(this)});Object.defineProperty(this,"isLowestLowestRow",{get:function(){return this.manager.getLowestLowestRow()===this}.bind(this)});Object.defineProperty(this,"isFirstRow",{get:function(){return this._isFirstRow}.bind(this),set:function(a){(this._isFirstRow=a)?(this.enabledCheckbox.disabled=!0,this.offsetInput.disabled=!0,this.fromInput.disabled=!0,this.offsetInput.style.visibility="hidden",this.fromInput.style.visibility="hidden"):
(this.enabledCheckbox.disabled=!1,this.offsetInput.disabled=!1,this.fromInput.disabled=!1,this.offsetInput.style.visibility="",this.fromInput.style.visibility="")}.bind(this)});this.update=function(){this.enabled?(this.body.style.color="",this.areaOutput.innerHTML=this.area,this.offsetInput.style.display="",this.fromInput.style.display="",this.moreButton.style.display="",this.lessButton.style.display="",this.barcodeInput.style.display="",this.offMessageOutput.style.display="none",this.isHighestHighestRow&&
(0!==this.offest&&(this.offset=0),this.offsetInput.style.display="none")):(this.areaOutput.innerHTML="",this.body.style.color="grey",this.offsetInput.style.display="none",this.fromInput.style.display="none",this.moreButton.style.display="none",this.lessButton.style.display="none",this.barcodeInput.style.display="none",this.offMessageOutput.style.display="");this.update_validity();this.dispatch("update",this)}.bind(this);this.change=function(){this.dispatch("change",this)}.bind(this);this.update_validity=
function(){0<this.getValidity().error.length?(this.body.style.backgroundColor="lightyellow",this.body.style.color="red"):(this.body.style.backgroundColor="",this.body.style.color="")}.bind(this);this.more=function(){var a=parseInt(vin.b.value);parseInt(vin.D.value);var c=parseInt(vin.df.value),e=parseInt(vin.cover.value),a=a-2*e-2*c;this.barcode=this.isAtLowestPosition||this.isAtHighestPosition?this._more_less_barcode(!0,10,300,20,a,this.area)||this.barcode:this._more_less_barcode(!0,2,Infinity,20,
a,this.area)||this.barcode}.bind(this);this.less=function(){var a=parseInt(vin.b.value);parseInt(vin.D.value);var c=parseInt(vin.df.value),e=parseInt(vin.cover.value),a=a-2*e-2*c;this.barcode=this.isAtLowestPosition||this.isAtHighestPosition?this._more_less_barcode(!1,10,300,20,a,this.area)||this.barcode:this._more_less_barcode(!1,2,Infinity,20,a,this.area)||this.barcode}.bind(this);this._more_less_barcode=function(a,c,e,g,f,h){var k=[],m,l,n,s,p;for(m=2;m<=c;m++)for(n=0;n<this.diameters.length;n++)l=
this.diameters[n],s=l*m+(m-1)*g,p=l*m+(m-1)*e,f>=s&&f<=p&&k.push({number:m,diameter:l,area:this.areas[n]*m});if(0==k.length)return console.log("never was possible combinations error"),"2N10";k.sort(function(c,e){return a?c.area-e.area:e.area-c.area});for(e=c=0;e<k.length-1;e++)c=Math.abs(k[e].area-k[e+1].area),50<c&&(k[e].number<k[e+1].number?k.splice(e+1,1):k[e].number>k[e+1].number&&(k.splice(e,1),e--));for(e=c=0;e<k.length-1;e++)c=Math.abs(k[e].area-k[e+1].area),50<c&&(k[e].number<=k[e+1].number/
2?k.splice(e+1,1):k[e+1].number<=k[e].number/2&&(k.splice(e,1),e--));for(e=0;e<k.length;e++)if(a){if(k[e].area>h)return k[e].number+"N"+k[e].diameter}else if(k[e].area<h)return k[e].number+"N"+k[e].diameter;return 0==k.length?(console.log("no possible combinations error"),"2N10"):k[k.length-1].number+"N"+k[k.length-1].diameter}.bind(this);this.getValidity=function(){var a={error:[],warning:[],infos:[]};if(!this.enabled)return a;var c=("Layer "+this.manager.getEnabledRowIndex(this)).bold();if(this.barcodeInput.value.match(/^[0-9]+N[0-9]+$/)){var e=
parseInt(this.barcodeInput.value.split("N")[0]),g=parseInt(this.barcodeInput.value.split("N")[1]);2>e?a.error.push(c+" has less than 2 bars. At least 2 bars in each layer are required to form a symmetrical reo cage for transportation."):this.isAtHighestPosition||this.isAtLowestPosition||2<e&&a.error.push(c+" has bars floating in mid air! This layer should have only 2 bars.");10<e&&a.error.push(c+" has too many bars (<b>>10</b>). Consider using larger bar diameters instead.");-1===this.diameters.indexOf(g)&&
a.error.push(c+" non-standard bar diameter. This software can only function with standard deformed bar diameters: ["+this.diameters.join(", ")+"] mm");var f=parseInt(vin.b.value),h=parseInt(vin.df.value),k=parseInt(vin.cover.value),e=(f-2*k-2*h-e*g)/(e-1);20>e&&a.error.push(c+" not enough space between bars (<20mm). Use fewer bars so that aggregate can completely surround the bars and and air bubbles can escape.");(this.isAtHighestPosition||this.isAtLowestPosition)&&300<e&&a.error.push(c+" has too much space between bars (>300mm) for crack control requirements! Only bars which are \u2265 half the diameter of the largest bar can be counted.")}else a.error.push(c+
' incorrect \'Bars\' column. This software uses the shorthand "<b>2N10</b>" to indicate 2 <a href="#help_bar_reoclass">normal ductility bars</a> with a diameter of 10mm.');this.isAtLowestPosition||this.isAtHighestPosition||20>this.offset&&a.error.push(c+" is too close to another layer. The <b>'Gap' should be at least 20mm</b> so that aggregate can completely surround the bars and and air bubbles can escape.");return a}.bind(this);this.create()};function ReoManager(a,d){EventDispatcher.call(this);this.beam=d;this.body=a;this.rows=[];this.create=function(){var a=this.createReoInput();a.isFirstRow=!0;a.enabled=!0;this.rows.push(a);this.rows.push(this.createReoInput());this.rows.push(this.createReoInput());this.rows.push(this.createReoInput());for(a=this.rows.length-1;0<=a;a--)this.rows[a].appendTo(this.body);this.update()}.bind(this);this.getEnabledRows=function(){for(var a=[],e=0;e<this.rows.length;e++)this.rows[e].enabled&&a.push(this.rows[e]);
return a}.bind(this);this.getRowIndex=function(a){for(var e=0;e<this.rows.length;e++)if(a===this.rows[e])return e}.bind(this);this.getEnabledRowIndex=function(a){for(var e=this.getEnabledRows(),d=0;d<e.length;d++)if(a===e[d])return d}.bind(this);this.getHighestHighestRow=function(){r=this.getEnabledRows();for(var a=r.length-1;0<=a;a--)if("highest"===r[a].from)return r[a]}.bind(this);this.getLowestLowestRow=function(){r=this.getEnabledRows();for(var a=0;a<r.length;a++)if("lowest"===r[a].from)return r[a]}.bind(this);
this.getDepthOfRow=function(a){var d=this.beam.D,g=this.beam.df,f=this.beam.cover,h=this.getEnabledRows();this.getLowestLowestRow();d=d-f-g;g=f+g;for(f=0;f<h.length;f++)if("lowest"===h[f].from){if(h[f]===a)return d-h[f].offset-h[f].diameter/2;d-=h[f].offset+h[f].diameter}for(f=h.length-1;0<=f;f--)if("highest"===h[f].from){if(h[f]===a)return g+h[f].offset+h[f].diameter/2;g+=h[f].offset+h[f].diameter}throw Error("Failed to get depth of row.");}.bind(this);this.createReoInput=function(){var a=new ReoInput(this);
a.on("update",this.update);a.on("change",this.change);return a}.bind(this);this.change=function(a){this.dispatch("change",this)}.bind(this);this.lock_update=!1;this.update=function(a){this.lock_update||(this.lock_update=!0,this.sort_rows(),this.update_renumberRows(),this.lock_update=!1,this.dispatch("update",this))}.bind(this);this.sort_rows=function(){var a=this.rows,d,g;for(i=0;i<a.length-1;i++)if(d=a[i],g=a[i+1],"highest"===d.from&&!0===d.enabled&&("lowest"===g.from&&!0===g.enabled||!1===g.enabled)||
!1===d.enabled&&"lowest"===g.from&&!0===g.enabled)this.swap_rows(d,g),i=0}.bind(this);this.swap_rows=function(a,d){var g=a.offset,f=a.barcode,h=a.from,k=a.enabled,m=a.isFirstRow;a.offset=d.offset;a.barcode=d.barcode;a.from=d.from;a.enabled=d.enabled;a.isFirstRow=d.isFirstRow;d.offset=g;d.barcode=f;d.from=h;d.enabled=k;d.isFirstRow=m}.bind(this);this.update_renumberRows=function(){for(var a=0;a<this.rows.length;a++)this.rows[a].layerNumberOutput.innerHTML="",this.rows[a].layerDepthOutput.innerHTML=
"",this.rows[a].layerDepthOutput.innerHTML="";for(var d=this.getEnabledRows(),a=0;a<d.length;a++)d[a].layerNumberOutput.innerHTML=a,d[a].layerDepthOutput.innerHTML=this.getDepthOfRow(d[a])}.bind(this);Object.defineProperty(this,"value",{get:function(){for(var a=[],d=this.getEnabledRows(),g,f=0;f<d.length;f++)g={number:d[f].number,diameter:d[f].diameter,area:d[f].area,depth:this.getDepthOfRow(d[f]),from:d[f].from,offset:d[f].offset},a.push(g);return a},set:function(a){}});this.create()};function tinyxhr(a,d,c,e,g){var f,h;try{h=new XMLHttpRequest}catch(k){try{h=new ActiveXObject("Msxml2.XMLHTTP")}catch(m){return console&&console.log("tinyxhr: XMLHttpRequest not supported"),null}}f=setTimeout(function(){h.abort();d(Error("tinyxhr: aborted by a timeout"),"",h)},1E4);h.onreadystatechange=function(){4==h.readyState&&(clearTimeout(f),d(200!=h.status?Error("tinyxhr: server respnse status is "+h.status):!1,h.responseText,h))};h.open(c?c.toUpperCase():"GET",a,!0);e?(h.setRequestHeader("Content-type",
g?g:"application/x-www-form-urlencoded"),h.send(e)):h.send()};function VarInput(a,d,c,e,g,f){EventDispatcher.call(this);this._options=f;this._notation="";this._type=c;this.validate=function(a){return a};this.buildInterface=function(){this.body=document.createElement("table");this.row=document.createElement("tr");this.body.className="varinput";this.notationDiv=document.createElement("td");this.notationDiv.className="notation-div";this.valueDiv=document.createElement("td");this.valueDiv.className="value-div";this.unitDiv=document.createElement("td");this.unitDiv.className=
"unit-div";this.helpDiv=document.createElement("td");this.helpDiv.className="help-div";this.helpAnchor=document.createElement("a");this.helpAnchor.href="#help_bar_"+a;this.helpButton=document.createElement("button");this.helpButton.className="help-button";this.helpButton.innerHTML="?";f?(this.valueInput=document.createElement("select"),this.options=f):"number"==c?(this.valueInput=document.createElement("input"),this.valueInput.type="number",this.valueInput.step=5,this.valueInput.min=0):"text"==c?
(this.valueInput=document.createElement("input"),this.valueInput.type="text"):(this.valueInput=document.createElement("input"),this.valueInput.type="none",this.valueInput.readonly=!0);this.valueDiv.appendChild(this.valueInput);this.row.appendChild(this.notationDiv);this.row.appendChild(this.valueDiv);this.row.appendChild(this.unitDiv);this.row.appendChild(this.helpDiv);this.helpDiv.appendChild(this.helpAnchor);this.helpAnchor.appendChild(this.helpButton);this.body.appendChild(this.row);this.notation=
d;this.id="var_input_"+a;this.unit=g;this.value=e}.bind(this);this.configureEvents=function(){this.valueInput.addEventListener("change",function(a){this.value=this.getValidity().value;this.update();this.change()}.bind(this));this.valueInput.addEventListener("input",function(a){a={value:this.value,error:[],warning:[],info:[]};this.validate(a);0<a.error.length&&this.valueInput.setCustomValidity("NO");this.update();this.change()}.bind(this));this.body.addEventListener("click",function(a){"INPUT"!==a.target.tagName&&
"SELECT"!==a.target.tagName&&(this.valueInput.click(),"SELECT"==this.valueInput.tagName?this.valueInput.focus():this.valueInput.select());this.update();this.change()}.bind(this))}.bind(this);this.update=function(){this.update_validity();this.dispatch("update",this)}.bind(this);this.change=function(){this.dispatch("change",this)}.bind(this);this.update_validity=function(){this.valid?this.valueInput.setCustomValidity(""):this.valueInput.setCustomValidity("invalid")}.bind(this);this.appendTo=function(a){a.appendChild(this.body);
this.updateMathJax();this.configureEvents()}.bind(this);this.updateMathJax=function(){if(document.body.contains(this.body))try{MathJax.Hub.Queue(["Typeset",MathJax.Hub,this.body])}catch(a){this.notation=this.id}}.bind(this);this.getValidity=function(){return this.validate({value:this.value,error:[],warning:[],info:[]})};Object.defineProperty(this,"valid",{get:function(){return 0==this.validate({value:this.value,error:[],warning:[],info:[]}).error.length}.bind(this)});Object.defineProperty(this,"notation",
{get:function(){return this._notation}.bind(this),set:function(a){this.notationDiv.innerHTML=a;this.updateMathJax()}.bind(this)});Object.defineProperty(this,"value",{get:function(){return"number"==this._type?parseInt(this.valueInput.value):this.valueInput.value}.bind(this),set:function(a){this.valueInput.value=a}.bind(this)});Object.defineProperty(this,"options",{get:function(){return this._options}.bind(this),set:function(a){this._options=a;for(a=0;a<this._options.length;a++){var c=document.createElement("option");
c.innerHTML=this._options[a];c.value=this._options[a];this.valueInput.appendChild(c)}}.bind(this)});Object.defineProperty(this,"unit",{get:function(){return this.unitDiv.innerHTML}.bind(this),set:function(a){this.unitDiv.innerHTML=a}.bind(this)});this.buildInterface()};function Vector(a,d){this.x=a||0;this.y=d||0;this.set=function(a,d){this.x=a;this.y=d;return this}.bind(this);this.fromVector=function(a){this.x=a.x;this.y=a.y;return this}.bind(this);this.fromPoints=function(a,d){this.x=d.x-a.x;this.y=d.y-a.y;return this};this.fromAngLen=function(a,d){this.x=Math.cos(a)*d;this.y=Math.sin(a)*d;return this}.bind(this);this.duplicate=this.copy=function(){return new Vector(this.x,this.y)}.bind(this);this.add=this.plus=function(a){this.x+=a.x;this.y+=a.y;return this}.bind(this);
this.addScalar=this.plusScalar=function(a){this.x+=a;this.y+=a;return this}.bind(this);this.subtract=this.minus=function(a){this.x-=a.x;this.y-=a.y;return this}.bind(this);this.subtractScalar=this.minusScalar=function(a){this.x-=a;this.y-=a;return this}.bind(this);this.scalar=function(a){this.x*=a;this.y*=a;return this}.bind(this);this.dot=function(a){return this.x*a.x+this.y*a.y}.bind(this);this.left=function(){var a=this.y;this.y=this.x;this.x=-a;return this}.bind(this);this.right=function(){var a=
this.y;this.y=-this.x;this.x=a;return this}.bind(this);this.unit=function(){var a=this.len;this.x/=a;this.y/=a;return this}.bind(this);Object.defineProperty(this,"lenSquared",{get:function(){return this.x*this.x+this.y*this.y}.bind(this)});Object.defineProperty(this,"len",{get:function(){return Math.sqrt(this.lenSquared)}.bind(this)});Object.defineProperty(this,"ang",{get:function(){return Math.atan2(this.y,this.x)}.bind(this)});this.toString=function(){return"<"+this.x.toFixed(2)+", "+this.y.toFixed(2)+
">"}.bind(this);this.rounded=function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this};this.moveTo=function(a){a.moveTo(this.x,this.y);return this}.bind(this);this.lineTo=function(a){a.lineTo(this.x,this.y);return this}.bind(this)};

</script>
	</html>